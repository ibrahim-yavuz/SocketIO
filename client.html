<html>

<head>
  <meta charset="utf-8" />
  <title>Gamedev Canvas Workshop</title>
  <style>
    * {
      padding: 0;
      margin: 0;
    }

    canvas {
      background: rgb(12, 187, 35);
      display: block;
      margin: 0 auto;
    }
  </style>
</head>

<body>

  <canvas id="myCanvas"></canvas>
  <script src="/socket.io/socket.io.js"></script>

  <script>
    var socket = io();
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");

    let x = canvas.width / 2;
    let y = canvas.height - 30;

    let keysPressed = {};

    let speed = 5;

    let characterRadius = 10;


    document.addEventListener('keydown', (event) => {
        keysPressed[event.key] = true;

        if(keysPressed['ArrowLeft'] || keysPressed['w']){
          x -= speed;

          if(x < characterRadius){
            x = characterRadius;
          }
        }

        if(keysPressed['ArrowRight']){
          x += speed;
        }

        if(keysPressed['ArrowUp']){
          y -= speed;
        }

        if(keysPressed['ArrowDown']){
          y += speed;
        }
    });

    document.addEventListener('keyup', (event) => {
        delete keysPressed[event.key];
    });


    async function drawCharacter(){
      var img1 = new Image();

      img1.onload = function () {
        ctx.drawImage(img1, 0, 0);
        ctx.fillStyle = "rgba(200, 0, 0, 0.5)";
        ctx.fillRect(0, 0, 500, 500);
      };
      img1.src = 'assets/tankBlue.png';
    }

    function loadImage(url) {
      return new Promise(r => { let i = new Image(); i.onload = (() => r(i)); i.src = url; });
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawCharacter();
    }

    function init() {
      canvas.width = document.body.clientWidth;
      canvas.height = document.body.clientHeight;
    }

    init();
    setInterval(draw, 10);
  </script>

</body>

</html>



<!--<script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
    
      var form = document.getElementById('form');
      var input = document.getElementById('input');
    
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (input.value) {
          socket.emit('chat message', input.value);
          input.value = '';
        }
      });
    </script>!-->